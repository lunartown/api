# Repository Guidelines

## Project Structure & Module Organization
- Root: `index.html` bootstraps the app; Vite config in `vite.config.ts` and TS config in `tsconfig.json`.
- Source: `src/`
  - `App.tsx`, `main.tsx`, `styles.css`: entry, mount, and global styles.
  - `components/`: UI building blocks (`Canvas.tsx`, `Columns.tsx`, `Subtable.tsx`).
  - `lib/`: core logic (`parser.ts` builds the registry/layers; `layout.ts` handles positioning/flow).
- Build output: `dist/` (generated by Vite).

## Build, Test, and Development Commands
- `npm run dev`: start Vite dev server at localhost with HMR.
- `npm run build`: production build to `dist/`.
- `npm run preview`: locally preview the production build.

## Coding Style & Naming Conventions
- Language: TypeScript + React 18; strict mode enabled (`tsconfig.json`).
- Indentation: 2 spaces; prefer single quotes; keep imports ES‑module style.
- Components: PascalCase filenames and exports (e.g., `Subtable.tsx`).
- Utilities: lowercase filenames in `lib/` (e.g., `parser.ts`), camelCase functions/variables, PascalCase types.
- React: function components with hooks; keep JSX presentational—move logic to `lib/` when possible.

## Testing & Verification
- E2E: Playwright tests live in `tests/`.
- Quick verify: `npm run verify` builds and runs the full Playwright suite, including layout invariants.
- Dev server self-check:
  - In DevTools console: `localStorage.setItem('layoutDebug','1'); location.reload()` to enable runtime layout checks.
  - After toggling, violations print as `[layoutDebug] stacking violations:` with concrete positions.
- Manual QA checklist:
  - `npm run dev` → paste Schema → Render.
  - Expand/collapse across root and children; confirm linked instance tables hide/show accordingly.
  - Drag/reorder, edit fields, verify undo/redo and zoom.

## Commit & Pull Request Guidelines
- Commits: concise, present‑tense; Conventional Commits preferred.
  - Example: `feat(columns): support drag-to-reorder rows`.
- PRs: include a clear description, linked issues, before/after screenshots or a short GIF, and test/QA notes.
- Keep changes scoped; update `AGENTS.md` or inline docs if behavior/UX changes.

## CI
- GitHub Actions workflow `.github/workflows/e2e.yml` runs on push/PR:
  - Node 20, `npm ci`, `npm run build`, then Playwright tests.
  - Uploads Playwright HTML report and raw `test-results` as artifacts.

## Security & Configuration Tips
- No secrets or tokens should be committed. This is a client‑only app; keep schemas/sample data non‑sensitive.
- When adding packages, prefer dev‑time tools that work with Vite and ESM.
